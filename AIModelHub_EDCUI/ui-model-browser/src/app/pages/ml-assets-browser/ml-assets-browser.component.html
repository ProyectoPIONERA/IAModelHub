<div class="ml-assets-browser">
  <!-- Header -->
  <div class="browser-header">
    <div class="header-content">
      <h1>
        <mat-icon class="header-icon">psychology</mat-icon>
        IA Models
      </h1>
      <p class="subtitle">Discover and access IA models from the dataspace</p>
    </div>
    <div class="header-actions">
      <button mat-fab extended color="accent" routerLink="/assets/create">
        <mat-icon>add_circle_outline</mat-icon>
        Create IA Asset
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Sidebar Filters -->
    <aside class="sidebar">
      <!-- Search Bar -->
      <app-ml-search-bar (searchChange)="onSearch($event)"></app-ml-search-bar>
      
      <!-- Filters -->
      <app-ml-filters
        [availableTasks]="availableTasks"
        [availableSubtasks]="availableSubtasks"
        [availableAlgorithms]="availableAlgorithms"
        [availableLibraries]="availableLibraries"
        [availableFrameworks]="availableFrameworks"
        [availableStorageTypes]="availableStorageTypes"
        [availableSoftware]="availableSoftware"
        [availableAssetSources]="availableAssetSources"
        [availableFormats]="availableFormats"
        (filterChange)="onFilterChange($event)"
      ></app-ml-filters>
    </aside>

    <!-- Assets Grid -->
    <main class="content-area">
      <!-- Loading State -->
      <div *ngIf="isLoading" class="state-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading IA models...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="isError" class="state-container error">
        <mat-icon>error_outline</mat-icon>
        <p>{{ errorMessage }}</p>
        <button mat-raised-button color="primary" (click)="retryLoading()">
          <mat-icon>refresh</mat-icon>
          Retry
        </button>
      </div>

      <!-- Results Summary -->
      <div *ngIf="!isLoading && !isError" class="results-summary">
        <span class="result-count">
          {{ filteredAssets.length }} model<span *ngIf="filteredAssets.length !== 1">s</span> found
        </span>
        <span class="page-info">
          Showing {{ displayedAssets.length }} of {{ filteredAssets.length }}
        </span>
      </div>

      <!-- Assets Grid -->
      <div *ngIf="!isLoading && !isError && hasResults" class="assets-grid" [style.grid-template-columns]="'repeat(' + gridCols + ', 1fr)'">
        <app-ml-asset-card
          *ngFor="let asset of displayedAssets"
          [asset]="asset"
          (viewDetails)="onViewDetails($event)"
          (downloadAsset)="onDownloadAsset($event)"
          (createContract)="onCreateContract($event)"
          (negotiate)="onNegotiate($event)"
        ></app-ml-asset-card>
      </div>

      <!-- No Results State -->
      <div *ngIf="!isLoading && !isError && !hasResults" class="state-container no-results">
        <mat-icon>inbox</mat-icon>
        <p>{{ noResultsMessage }}</p>
        <button mat-button (click)="retryLoading()">
          <mat-icon>refresh</mat-icon>
          Refresh
        </button>
      </div>

      <!-- Paginator -->
      <div *ngIf="!isLoading && !isError && hasResults" class="paginator-container">
        <mat-paginator
          [length]="totalItems"
          [pageSize]="pageSize"
          [pageSizeOptions]="[6, 12, 24, 48]"
          [showFirstLastButtons]="true"
          (page)="onPageChange($event)"
          aria-label="Select page"
        ></mat-paginator>
      </div>
    </main>
  </div>
</div>
