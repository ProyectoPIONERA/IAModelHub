{
  "extension": {
    "name": "s3-chunked-upload-extension",
    "displayName": "S3 Chunked Upload Extension",
    "version": "1.0.0",
    "description": "Provides multipart chunked file upload capability to S3/MinIO storage. Supports large file uploads with progress tracking and resumable sessions.",
    "provider": "IA EDC Connector",
    "category": "data-transfer",
    "type": "ServiceExtension"
  },
  "provides": [
    {
      "service": "ChunkedUploadService",
      "interface": "spi/storage/chunked-upload-spi.js",
      "implementation": "extensions/s3-chunked-upload/chunked-upload-service.js"
    },
    {
      "service": "UploadSessionStore",
      "interface": "spi/storage/chunked-upload-spi.js",
      "implementation": "extensions/s3-chunked-upload/postgres-session-store.js"
    }
  ],
  "requires": [
    {
      "service": "DataSource",
      "description": "PostgreSQL for upload session tracking"
    },
    {
      "service": "IdentityService",
      "description": "User authentication for uploads"
    }
  ],
  "configuration": {
    "s3.endpoint": {
      "type": "string",
      "description": "S3/MinIO endpoint URL",
      "required": true,
      "env": "S3_ENDPOINT"
    },
    "s3.bucket": {
      "type": "string",
      "description": "S3 bucket name for assets",
      "required": true,
      "env": "S3_BUCKET"
    },
    "s3.accessKey": {
      "type": "string",
      "description": "S3 access key ID",
      "required": true,
      "env": "S3_ACCESS_KEY"
    },
    "s3.secretKey": {
      "type": "string",
      "description": "S3 secret access key",
      "required": true,
      "env": "S3_SECRET_KEY"
    },
    "upload.chunkSize": {
      "type": "number",
      "description": "Maximum chunk size in MB",
      "default": 5
    },
    "upload.maxFileSize": {
      "type": "number",
      "description": "Maximum file size in GB",
      "default": 10
    }
  },
  "endpoints": {
    "management": [
      {
        "path": "/s3assets/init-upload",
        "method": "POST",
        "description": "Initialize multipart upload session",
        "requiresAuth": true
      },
      {
        "path": "/s3assets/upload-chunk",
        "method": "POST",
        "description": "Upload a file chunk",
        "requiresAuth": true
      },
      {
        "path": "/s3assets/finalize-upload",
        "method": "POST",
        "description": "Complete upload and create asset",
        "requiresAuth": true
      },
      {
        "path": "/s3assets/abort-upload",
        "method": "POST",
        "description": "Cancel ongoing upload",
        "requiresAuth": true
      }
    ]
  },
  "database": {
    "tables": [
      {
        "name": "upload_sessions",
        "description": "Tracks multipart upload sessions",
        "schema": "database/migrations/upload_sessions_schema.sql"
      },
      {
        "name": "upload_chunks",
        "description": "Records uploaded chunks",
        "schema": "database/migrations/upload_chunks_schema.sql"
      }
    ]
  },
  "compatibility": {
    "edc": {
      "version": ">=0.5.0",
      "javaEquivalent": "org.iaspace.connector.s3.S3ChunkedUploadExtension",
      "spi": "org.eclipse.edc.spi.types.domain.transfer.DataFlowStartMessage"
    }
  }
}
